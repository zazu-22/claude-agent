[
  {
    "category": "technical",
    "description": "WorkflowConfig dataclass exists in config.py with correct default values (default='full', auto_spec_enabled=False, skip_if_feature_list_exists=True)",
    "steps": [
      "Step 1: Open src/claude_agent/config.py",
      "Step 2: Verify WorkflowConfig dataclass is defined",
      "Step 3: Verify default field equals 'full'",
      "Step 4: Verify auto_spec_enabled field defaults to False",
      "Step 5: Verify skip_if_feature_list_exists field defaults to True"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "Config dataclass includes workflow field of type WorkflowConfig with proper default factory",
    "steps": [
      "Step 1: Open src/claude_agent/config.py",
      "Step 2: Locate the Config dataclass definition",
      "Step 3: Verify workflow field exists with type WorkflowConfig",
      "Step 4: Verify default_factory is set to WorkflowConfig"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "Config file loading correctly parses workflow section from YAML configuration",
    "steps": [
      "Step 1: Create test YAML with workflow.default='spec-only'",
      "Step 2: Call load_config_file on the test YAML",
      "Step 3: Verify workflow.default is correctly parsed as 'spec-only'",
      "Step 4: Verify workflow.auto_spec.enabled is correctly parsed",
      "Step 5: Verify workflow.auto_spec.skip_if_feature_list_exists is correctly parsed"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "merge_config correctly applies workflow settings from config file with proper priority",
    "steps": [
      "Step 1: Create config file with workflow settings",
      "Step 2: Call merge_config with the config file path",
      "Step 3: Verify workflow settings are applied to resulting Config",
      "Step 4: Verify CLI overrides would take priority if implemented"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "SPEC_WORKFLOW_FILE constant is defined in progress.py as 'spec-workflow.json'",
    "steps": [
      "Step 1: Open src/claude_agent/progress.py",
      "Step 2: Verify SPEC_WORKFLOW_FILE constant exists",
      "Step 3: Verify its value is 'spec-workflow.json'"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "get_spec_workflow_state returns empty state for new project without spec-workflow.json",
    "steps": [
      "Step 1: Create empty temporary directory",
      "Step 2: Call get_spec_workflow_state with temp directory",
      "Step 3: Verify returned state has phase='none'",
      "Step 4: Verify returned state has empty history list"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "save_spec_workflow_state creates spec-workflow.json with correct JSON structure",
    "steps": [
      "Step 1: Create temporary directory",
      "Step 2: Create state dict with phase='created' and history",
      "Step 3: Call save_spec_workflow_state with state",
      "Step 4: Verify spec-workflow.json file exists",
      "Step 5: Verify JSON content matches input state"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "get_spec_workflow_state and save_spec_workflow_state perform correct roundtrip",
    "steps": [
      "Step 1: Create state with phase='validated' and history entries",
      "Step 2: Call save_spec_workflow_state",
      "Step 3: Call get_spec_workflow_state",
      "Step 4: Verify loaded state matches original state",
      "Step 5: Verify history array is preserved exactly"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "record_spec_step appends to history without replacing existing entries",
    "steps": [
      "Step 1: Call record_spec_step with 'create' step",
      "Step 2: Call record_spec_step with 'validate' step",
      "Step 3: Load spec workflow state",
      "Step 4: Verify history has 2 entries",
      "Step 5: Verify first entry is 'create' and second is 'validate'"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "record_spec_step includes timestamp in ISO format for each entry",
    "steps": [
      "Step 1: Call record_spec_step with any step",
      "Step 2: Load spec workflow state",
      "Step 3: Verify timestamp field exists in history entry",
      "Step 4: Verify timestamp is valid ISO 8601 format"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "record_spec_step updates phase field based on step type",
    "steps": [
      "Step 1: Call record_spec_step with 'create' step",
      "Step 2: Verify phase is 'created'",
      "Step 3: Call record_spec_step with 'validate' step",
      "Step 4: Verify phase is 'validated'",
      "Step 5: Call record_spec_step with 'decompose' step",
      "Step 6: Verify phase is 'decomposed'"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "get_spec_phase returns 'none' when no spec files exist",
    "steps": [
      "Step 1: Create empty temporary directory",
      "Step 2: Call get_spec_phase",
      "Step 3: Verify return value is 'none'"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "get_spec_phase returns 'created' when only spec-draft.md exists",
    "steps": [
      "Step 1: Create temporary directory with spec-draft.md",
      "Step 2: Call get_spec_phase",
      "Step 3: Verify return value is 'created'"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "get_spec_phase returns 'validated' when spec-validated.md exists",
    "steps": [
      "Step 1: Create temporary directory with spec-draft.md and spec-validated.md",
      "Step 2: Call get_spec_phase",
      "Step 3: Verify return value is 'validated'"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "get_spec_phase returns 'decomposed' when feature_list.json exists with validated spec",
    "steps": [
      "Step 1: Create temporary directory with spec-draft.md, spec-validated.md, and feature_list.json",
      "Step 2: Call get_spec_phase",
      "Step 3: Verify return value is 'decomposed'"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "spec_create.md prompt template exists in prompts directory",
    "steps": [
      "Step 1: Check if src/claude_agent/prompts/spec_create.md exists",
      "Step 2: Verify file is not empty",
      "Step 3: Verify file contains {{goal}} placeholder",
      "Step 4: Verify file contains {{context}} placeholder"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "spec_validate.md prompt template exists in prompts directory",
    "steps": [
      "Step 1: Check if src/claude_agent/prompts/spec_validate.md exists",
      "Step 2: Verify file is not empty",
      "Step 3: Verify file contains {{spec_content}} placeholder"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "spec_decompose.md prompt template exists in prompts directory",
    "steps": [
      "Step 1: Check if src/claude_agent/prompts/spec_decompose.md exists",
      "Step 2: Verify file is not empty",
      "Step 3: Verify file contains {{spec_content}} placeholder",
      "Step 4: Verify file contains {{feature_count}} placeholder"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "spec_create.md prompt includes all required sections per spec (Project Overview, Functional Requirements, Technical Requirements, Non-Functional Requirements, Out of Scope, Open Questions)",
    "steps": [
      "Step 1: Read spec_create.md content",
      "Step 2: Verify 'Project Overview' section is mentioned",
      "Step 3: Verify 'Functional Requirements' section is mentioned",
      "Step 4: Verify 'Technical Requirements' section is mentioned",
      "Step 5: Verify 'Non-Functional Requirements' section is mentioned",
      "Step 6: Verify 'Out of Scope' section is mentioned",
      "Step 7: Verify 'Open Questions' section is mentioned"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "spec_validate.md prompt includes BLOCKING, WARNING, SUGGESTION issue categories",
    "steps": [
      "Step 1: Read spec_validate.md content",
      "Step 2: Verify 'BLOCKING' issue category is defined",
      "Step 3: Verify 'WARNING' issue category is defined",
      "Step 4: Verify 'SUGGESTION' issue category is defined"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "spec_validate.md prompt includes PASS/FAIL verdict instruction",
    "steps": [
      "Step 1: Read spec_validate.md content",
      "Step 2: Verify PASS verdict is documented",
      "Step 3: Verify FAIL verdict is documented",
      "Step 4: Verify conditions for each verdict are explained"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "spec_decompose.md prompt includes feature_list.json structure specification",
    "steps": [
      "Step 1: Read spec_decompose.md content",
      "Step 2: Verify JSON structure example is provided",
      "Step 3: Verify 'category' field is documented",
      "Step 4: Verify 'description' field is documented",
      "Step 5: Verify 'steps' array is documented",
      "Step 6: Verify 'passes' field is documented",
      "Step 7: Verify 'requires_manual_testing' field is documented"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "get_spec_create_prompt function exists and properly renders goal into template",
    "steps": [
      "Step 1: Import get_spec_create_prompt from prompts/loader.py",
      "Step 2: Call with goal='Build a todo app'",
      "Step 3: Verify 'Build a todo app' appears in returned prompt",
      "Step 4: Verify 'SPEC CREATOR' role identifier is present"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "get_spec_create_prompt includes context when provided",
    "steps": [
      "Step 1: Call get_spec_create_prompt with goal and context",
      "Step 2: Verify goal appears in prompt",
      "Step 3: Verify context appears in prompt",
      "Step 4: Verify context section header is present"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "get_spec_create_prompt excludes context section when context is empty",
    "steps": [
      "Step 1: Call get_spec_create_prompt with goal only (empty context)",
      "Step 2: Verify goal appears in prompt",
      "Step 3: Verify ADDITIONAL CONTEXT section is not present"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "get_spec_validate_prompt function exists and includes spec content",
    "steps": [
      "Step 1: Import get_spec_validate_prompt from prompts/loader.py",
      "Step 2: Call with spec_content='# My Spec\\n\\nDetails'",
      "Step 3: Verify 'My Spec' appears in returned prompt",
      "Step 4: Verify 'SPEC VALIDATOR' role identifier is present"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "get_spec_decompose_prompt function exists and includes feature count",
    "steps": [
      "Step 1: Import get_spec_decompose_prompt from prompts/loader.py",
      "Step 2: Call with spec_content and feature_count=75",
      "Step 3: Verify '75' appears in returned prompt",
      "Step 4: Verify 'SPEC DECOMPOSER' role identifier is present"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "run_spec_create_session function exists in agent.py and returns tuple (status, spec_path)",
    "steps": [
      "Step 1: Import run_spec_create_session from agent.py",
      "Step 2: Verify function signature includes config and goal parameters",
      "Step 3: Verify function is async",
      "Step 4: Verify return type annotation indicates tuple"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "run_spec_validate_session function exists in agent.py and returns tuple (status, passed)",
    "steps": [
      "Step 1: Import run_spec_validate_session from agent.py",
      "Step 2: Verify function signature includes config and spec_path parameters",
      "Step 3: Verify function is async",
      "Step 4: Verify return type indicates tuple with bool for passed"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "run_spec_decompose_session function exists in agent.py and returns tuple (status, feature_list_path)",
    "steps": [
      "Step 1: Import run_spec_decompose_session from agent.py",
      "Step 2: Verify function signature includes config, spec_path, and feature_count parameters",
      "Step 3: Verify function is async",
      "Step 4: Verify return type indicates tuple with Path for feature_list_path"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "run_spec_workflow function exists in agent.py for auto mode orchestration",
    "steps": [
      "Step 1: Import run_spec_workflow from agent.py",
      "Step 2: Verify function signature includes config and goal parameters",
      "Step 3: Verify function is async",
      "Step 4: Verify return type is bool"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "run_spec_create_session records step in spec-workflow.json after completion",
    "steps": [
      "Step 1: Mock Claude client to return success",
      "Step 2: Create spec-draft.md in temp directory",
      "Step 3: Call run_spec_create_session",
      "Step 4: Verify spec-workflow.json exists",
      "Step 5: Verify 'create' step is recorded in history"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "run_spec_validate_session records step with passed=true when spec-validated.md created",
    "steps": [
      "Step 1: Mock Claude client to create spec-validated.md",
      "Step 2: Create spec-draft.md in temp directory",
      "Step 3: Call run_spec_validate_session",
      "Step 4: Verify 'validate' step is recorded with passed=true"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "run_spec_validate_session records step with passed=false when validation fails",
    "steps": [
      "Step 1: Mock Claude client to NOT create spec-validated.md",
      "Step 2: Create spec-draft.md in temp directory",
      "Step 3: Call run_spec_validate_session",
      "Step 4: Verify 'validate' step is recorded with passed=false"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "run_spec_decompose_session records step and feature_count in history",
    "steps": [
      "Step 1: Mock Claude client to create feature_list.json",
      "Step 2: Create spec-validated.md in temp directory",
      "Step 3: Call run_spec_decompose_session with feature_count=60",
      "Step 4: Verify 'decompose' step is recorded",
      "Step 5: Verify feature_count=60 is recorded in history entry"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "run_spec_workflow returns False and exits early if spec creation fails",
    "steps": [
      "Step 1: Mock Claude client to NOT create spec-draft.md",
      "Step 2: Call run_spec_workflow",
      "Step 3: Verify return value is False",
      "Step 4: Verify validation was not attempted"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "run_spec_workflow returns False and exits after validation failure",
    "steps": [
      "Step 1: Mock spec creation to succeed",
      "Step 2: Mock validation to fail (no spec-validated.md)",
      "Step 3: Call run_spec_workflow",
      "Step 4: Verify return value is False",
      "Step 5: Verify decomposition was not attempted"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "run_spec_workflow returns True when all three steps succeed",
    "steps": [
      "Step 1: Mock all three sessions to succeed",
      "Step 2: Call run_spec_workflow",
      "Step 3: Verify return value is True",
      "Step 4: Verify all three files exist (spec-draft.md, spec-validated.md, feature_list.json)"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "run_spec_workflow prints progress banner at start",
    "steps": [
      "Step 1: Capture stdout during run_spec_workflow",
      "Step 2: Verify 'SPEC WORKFLOW - AUTO MODE' appears in output",
      "Step 3: Verify goal is printed"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "run_spec_workflow prints summary of generated files at completion",
    "steps": [
      "Step 1: Mock all sessions to succeed",
      "Step 2: Capture stdout during run_spec_workflow",
      "Step 3: Verify 'SPEC WORKFLOW COMPLETE' appears in output",
      "Step 4: Verify list of generated files is printed"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "spec command group exists in cli.py",
    "steps": [
      "Step 1: Import main from cli.py",
      "Step 2: Verify 'spec' command group is registered",
      "Step 3: Verify it has a help description"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: 'claude-agent spec --help' shows subcommands",
    "steps": [
      "Step 1: Run 'uv run claude-agent spec --help'",
      "Step 2: Verify output includes 'create' subcommand",
      "Step 3: Verify output includes 'validate' subcommand",
      "Step 4: Verify output includes 'decompose' subcommand",
      "Step 5: Verify output includes 'auto' subcommand",
      "Step 6: Verify output includes 'status' subcommand"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: 'claude-agent spec create --help' shows correct options",
    "steps": [
      "Step 1: Run 'uv run claude-agent spec create --help'",
      "Step 2: Verify -g/--goal option is shown",
      "Step 3: Verify --from-file option is shown",
      "Step 4: Verify -i/--interactive option is shown",
      "Step 5: Verify -p/--project-dir option is shown"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: 'claude-agent spec validate --help' shows correct options",
    "steps": [
      "Step 1: Run 'uv run claude-agent spec validate --help'",
      "Step 2: Verify SPEC_FILE argument is shown",
      "Step 3: Verify -i/--interactive option is shown",
      "Step 4: Verify -p/--project-dir option is shown"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: 'claude-agent spec decompose --help' shows correct options",
    "steps": [
      "Step 1: Run 'uv run claude-agent spec decompose --help'",
      "Step 2: Verify SPEC_FILE argument is shown",
      "Step 3: Verify -f/--features option is shown",
      "Step 4: Verify -p/--project-dir option is shown"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: 'claude-agent spec auto --help' shows correct options",
    "steps": [
      "Step 1: Run 'uv run claude-agent spec auto --help'",
      "Step 2: Verify -g/--goal option is shown as required",
      "Step 3: Verify -p/--project-dir option is shown"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: 'claude-agent spec status --help' shows correct options",
    "steps": [
      "Step 1: Run 'uv run claude-agent spec status --help'",
      "Step 2: Verify -p/--project-dir option is shown"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: spec create fails with clear error when no goal provided",
    "steps": [
      "Step 1: Run 'uv run claude-agent spec create'",
      "Step 2: Verify exit code is non-zero",
      "Step 3: Verify error message mentions --goal or --from-file required"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: spec create accepts goal from --from-file",
    "steps": [
      "Step 1: Create temp file with goal text",
      "Step 2: Run 'uv run claude-agent spec create --from-file <temp>'",
      "Step 3: Verify goal is read from file"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: spec validate fails with clear error when spec file not found",
    "steps": [
      "Step 1: Run 'uv run claude-agent spec validate' in empty directory",
      "Step 2: Verify exit code is non-zero",
      "Step 3: Verify error message mentions spec-draft.md not found",
      "Step 4: Verify suggestion to run spec create first"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: spec validate defaults to spec-draft.md when no argument",
    "steps": [
      "Step 1: Create spec-draft.md in temp directory",
      "Step 2: Run 'uv run claude-agent spec validate -p <temp>'",
      "Step 3: Verify it attempts to validate spec-draft.md"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: spec validate accepts explicit spec file path",
    "steps": [
      "Step 1: Create custom-spec.md in temp directory",
      "Step 2: Run 'uv run claude-agent spec validate custom-spec.md -p <temp>'",
      "Step 3: Verify it validates custom-spec.md"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: spec decompose defaults to spec-validated.md when no argument",
    "steps": [
      "Step 1: Create spec-validated.md in temp directory",
      "Step 2: Run 'uv run claude-agent spec decompose -p <temp>'",
      "Step 3: Verify it attempts to decompose spec-validated.md"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: spec decompose falls back to spec-draft.md with warning when validated not found",
    "steps": [
      "Step 1: Create spec-draft.md in temp directory (no spec-validated.md)",
      "Step 2: Run 'uv run claude-agent spec decompose -p <temp>'",
      "Step 3: Verify warning about using unvalidated draft is shown",
      "Step 4: Verify it proceeds with spec-draft.md"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: spec decompose accepts -f/--features to set target count",
    "steps": [
      "Step 1: Create spec-validated.md in temp directory",
      "Step 2: Run 'uv run claude-agent spec decompose -f 100 -p <temp>'",
      "Step 3: Verify feature count 100 is used in decomposition"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: spec decompose defaults to 50 features when not specified",
    "steps": [
      "Step 1: Create spec-validated.md in temp directory",
      "Step 2: Run 'uv run claude-agent spec decompose -p <temp>'",
      "Step 3: Verify feature count 50 is used"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: spec auto requires --goal flag",
    "steps": [
      "Step 1: Run 'uv run claude-agent spec auto'",
      "Step 2: Verify exit code is non-zero",
      "Step 3: Verify error mentions --goal is required"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: spec auto runs all three steps in sequence",
    "steps": [
      "Step 1: Mock Claude client for all sessions",
      "Step 2: Run spec auto with goal",
      "Step 3: Verify create step ran",
      "Step 4: Verify validate step ran",
      "Step 5: Verify decompose step ran"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: spec auto exits with code 0 on success",
    "steps": [
      "Step 1: Mock all steps to succeed",
      "Step 2: Run spec auto",
      "Step 3: Verify exit code is 0"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: spec auto exits with code 1 on failure",
    "steps": [
      "Step 1: Mock validation to fail",
      "Step 2: Run spec auto",
      "Step 3: Verify exit code is 1"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: spec status shows 'Phase: none' for empty project",
    "steps": [
      "Step 1: Create empty temp directory",
      "Step 2: Run 'uv run claude-agent spec status -p <temp>'",
      "Step 3: Verify 'Phase: none' appears in output"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: spec status shows file existence status",
    "steps": [
      "Step 1: Create temp directory with spec-draft.md",
      "Step 2: Run 'uv run claude-agent spec status -p <temp>'",
      "Step 3: Verify 'Spec draft: exists' appears",
      "Step 4: Verify 'Validated spec: not created' appears"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: spec status shows workflow history when available",
    "steps": [
      "Step 1: Create temp directory with spec-workflow.json containing history",
      "Step 2: Run spec status",
      "Step 3: Verify history entries are displayed",
      "Step 4: Verify timestamps are shown"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: spec status suggests next command for 'none' phase",
    "steps": [
      "Step 1: Create empty temp directory",
      "Step 2: Run spec status",
      "Step 3: Verify suggestion mentions 'spec create'"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: main command has --auto-spec flag",
    "steps": [
      "Step 1: Run 'uv run claude-agent --help'",
      "Step 2: Verify --auto-spec option is shown",
      "Step 3: Verify description mentions spec workflow"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: --auto-spec requires --goal flag",
    "steps": [
      "Step 1: Run 'uv run claude-agent --auto-spec'",
      "Step 2: Verify exit code is non-zero",
      "Step 3: Verify error mentions --goal is required"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: --auto-spec runs spec workflow before coding agent",
    "steps": [
      "Step 1: Mock all sessions",
      "Step 2: Run main with --auto-spec -g 'test goal'",
      "Step 3: Verify spec workflow runs first",
      "Step 4: Verify coding agent starts after workflow completes"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: --auto-spec exits if spec workflow fails",
    "steps": [
      "Step 1: Mock spec validation to fail",
      "Step 2: Run main with --auto-spec",
      "Step 3: Verify coding agent does not start",
      "Step 4: Verify error message about spec workflow failure"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "spec_wizard.py module exists",
    "steps": [
      "Step 1: Check if src/claude_agent/spec_wizard.py exists"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "interactive_spec_create function returns (goal, context) tuple",
    "steps": [
      "Step 1: Import interactive_spec_create from spec_wizard.py",
      "Step 2: Verify function signature",
      "Step 3: Verify return type is tuple[Optional[str], str]"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "interactive_spec_create returns (None, '') when cancelled",
    "steps": [
      "Step 1: Mock questionary to return None",
      "Step 2: Call interactive_spec_create",
      "Step 3: Verify return is (None, '')"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "interactive_spec_create prompts for goal with multiline input",
    "steps": [
      "Step 1: Mock questionary",
      "Step 2: Call interactive_spec_create",
      "Step 3: Verify questionary.text was called with multiline=True"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "interactive_spec_create optionally prompts for additional context",
    "steps": [
      "Step 1: Mock questionary confirm to return True",
      "Step 2: Call interactive_spec_create",
      "Step 3: Verify additional context prompt appears",
      "Step 4: Verify context is returned in tuple"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "interactive_spec_create skips context prompt when user declines",
    "steps": [
      "Step 1: Mock questionary confirm to return False",
      "Step 2: Call interactive_spec_create",
      "Step 3: Verify context text prompt is not shown",
      "Step 4: Verify empty context is returned"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "interactive_spec_review function returns action string",
    "steps": [
      "Step 1: Import interactive_spec_review from spec_wizard.py",
      "Step 2: Verify return type is str",
      "Step 3: Verify valid return values include 'continue', 'view', 'edit', 'regenerate'"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "interactive_validation_review shows different options based on passed flag",
    "steps": [
      "Step 1: Import interactive_validation_review from spec_wizard.py",
      "Step 2: Call with passed=True",
      "Step 3: Verify 'Continue to decomposition' is an option",
      "Step 4: Call with passed=False",
      "Step 5: Verify 'View blocking issues' is an option"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: spec create -i launches interactive mode",
    "steps": [
      "Step 1: Mock interactive_spec_create",
      "Step 2: Run 'uv run claude-agent spec create -i'",
      "Step 3: Verify interactive_spec_create was called"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: spec create -i exits gracefully on cancel",
    "steps": [
      "Step 1: Mock interactive_spec_create to return (None, '')",
      "Step 2: Run 'uv run claude-agent spec create -i'",
      "Step 3: Verify 'Cancelled' message appears",
      "Step 4: Verify exit code is 0"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI: spec validate -i launches interactive validation review",
    "steps": [
      "Step 1: Create spec-draft.md",
      "Step 2: Mock validation session and interactive_validation_review",
      "Step 3: Run 'uv run claude-agent spec validate -i'",
      "Step 4: Verify interactive_validation_review was called"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "integration",
    "description": "Full workflow: spec create produces valid spec-draft.md",
    "steps": [
      "Step 1: Set up test environment with Claude mock",
      "Step 2: Run spec create with simple goal",
      "Step 3: Verify spec-draft.md exists",
      "Step 4: Verify spec-draft.md contains expected sections",
      "Step 5: Verify spec-draft.md is valid markdown"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "integration",
    "description": "Full workflow: spec validate produces spec-validation.md",
    "steps": [
      "Step 1: Create spec-draft.md with sample content",
      "Step 2: Run spec validate",
      "Step 3: Verify spec-validation.md exists",
      "Step 4: Verify validation report contains issues section",
      "Step 5: Verify validation report contains verdict"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "integration",
    "description": "Full workflow: spec validate produces spec-validated.md on pass",
    "steps": [
      "Step 1: Create comprehensive spec-draft.md",
      "Step 2: Mock validation to pass",
      "Step 3: Run spec validate",
      "Step 4: Verify spec-validated.md exists",
      "Step 5: Verify spec-validated.md contains improved content"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "integration",
    "description": "Full workflow: spec decompose produces valid feature_list.json",
    "steps": [
      "Step 1: Create spec-validated.md",
      "Step 2: Run spec decompose",
      "Step 3: Verify feature_list.json exists",
      "Step 4: Verify JSON is valid",
      "Step 5: Verify array structure with category, description, steps, passes fields"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "integration",
    "description": "Full workflow: spec decompose copies spec to app_spec.txt",
    "steps": [
      "Step 1: Create spec-validated.md",
      "Step 2: Run spec decompose",
      "Step 3: Verify app_spec.txt exists",
      "Step 4: Verify app_spec.txt content matches spec-validated.md"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "integration",
    "description": "Full workflow: spec auto creates all expected files",
    "steps": [
      "Step 1: Run spec auto with test goal",
      "Step 2: Verify spec-draft.md exists",
      "Step 3: Verify spec-validation.md exists",
      "Step 4: Verify spec-validated.md exists",
      "Step 5: Verify feature_list.json exists",
      "Step 6: Verify spec-workflow.json exists",
      "Step 7: Verify app_spec.txt exists"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "integration",
    "description": "Full workflow: spec workflow state is consistent after auto completion",
    "steps": [
      "Step 1: Run spec auto to completion",
      "Step 2: Read spec-workflow.json",
      "Step 3: Verify phase is 'decomposed'",
      "Step 4: Verify history has exactly 3 entries",
      "Step 5: Verify entries are in order: create, validate, decompose"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "integration",
    "description": "Full workflow: coding agent can run after spec workflow",
    "steps": [
      "Step 1: Run spec auto to completion",
      "Step 2: Run main claude-agent command",
      "Step 3: Verify coding agent starts (not initializer)",
      "Step 4: Verify feature_list.json is used"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "error-handling",
    "description": "spec create handles Claude API errors gracefully",
    "steps": [
      "Step 1: Mock Claude client to raise exception",
      "Step 2: Run spec create",
      "Step 3: Verify error is caught and displayed",
      "Step 4: Verify non-zero exit code"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "error-handling",
    "description": "spec validate handles malformed spec content gracefully",
    "steps": [
      "Step 1: Create spec-draft.md with minimal content",
      "Step 2: Run spec validate",
      "Step 3: Verify validation proceeds without crash",
      "Step 4: Verify validation report mentions issues"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "error-handling",
    "description": "spec decompose handles empty spec file gracefully",
    "steps": [
      "Step 1: Create empty spec-validated.md",
      "Step 2: Run spec decompose",
      "Step 3: Verify error message is clear",
      "Step 4: Verify non-zero exit code"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "error-handling",
    "description": "spec-workflow.json handles concurrent access safely",
    "steps": [
      "Step 1: Create initial spec-workflow.json",
      "Step 2: Simulate concurrent record_spec_step calls",
      "Step 3: Verify file is not corrupted",
      "Step 4: Verify all history entries are preserved"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "error-handling",
    "description": "spec status handles corrupted spec-workflow.json gracefully",
    "steps": [
      "Step 1: Create spec-workflow.json with invalid JSON",
      "Step 2: Run spec status",
      "Step 3: Verify no crash occurs",
      "Step 4: Verify error or fallback message is shown"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "error-handling",
    "description": "get_spec_workflow_state returns default for corrupted JSON",
    "steps": [
      "Step 1: Create spec-workflow.json with invalid JSON",
      "Step 2: Call get_spec_workflow_state",
      "Step 3: Verify default state is returned (phase='none')",
      "Step 4: Verify no exception is raised"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "error-handling",
    "description": "spec create handles keyboard interrupt gracefully",
    "steps": [
      "Step 1: Start spec create",
      "Step 2: Send keyboard interrupt (Ctrl+C)",
      "Step 3: Verify clean exit",
      "Step 4: Verify partial files are not corrupted"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "error-handling",
    "description": "spec workflow preserves state on unexpected exit",
    "steps": [
      "Step 1: Start spec auto",
      "Step 2: Kill process after spec create completes",
      "Step 3: Run spec status",
      "Step 4: Verify 'created' phase is shown",
      "Step 5: Verify workflow can resume with spec validate"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "style",
    "description": "Session headers use consistent formatting with existing agent.py",
    "steps": [
      "Step 1: Run spec create and capture output",
      "Step 2: Verify header uses '=' separator lines",
      "Step 3: Verify header width matches existing patterns (70 chars)",
      "Step 4: Compare with existing print_session_header format"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "style",
    "description": "CLI help text follows existing patterns",
    "steps": [
      "Step 1: Run spec --help",
      "Step 2: Verify description format matches existing subcommands",
      "Step 3: Verify option formatting matches existing CLI style"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "style",
    "description": "Error messages are clear and actionable",
    "steps": [
      "Step 1: Trigger various error conditions",
      "Step 2: Verify messages explain what went wrong",
      "Step 3: Verify messages suggest how to fix the issue"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "style",
    "description": "Progress output uses click.echo consistently",
    "steps": [
      "Step 1: Review spec command implementations",
      "Step 2: Verify all user-facing output uses click.echo",
      "Step 3: Verify no direct print() calls for CLI output"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "All new functions have docstrings with Args and Returns",
    "steps": [
      "Step 1: List all new functions in agent.py",
      "Step 2: Verify each has docstring",
      "Step 3: Verify Args section is present",
      "Step 4: Verify Returns section is present"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "All new functions have type hints",
    "steps": [
      "Step 1: List all new functions",
      "Step 2: Verify function parameters have type hints",
      "Step 3: Verify return types are annotated"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "Import statements follow project conventions (stdlib, third-party, local)",
    "steps": [
      "Step 1: Open modified files",
      "Step 2: Verify import order: stdlib first",
      "Step 3: Verify import order: third-party second",
      "Step 4: Verify import order: local imports last"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "New code passes ruff linting",
    "steps": [
      "Step 1: Run 'uv run ruff check src/claude_agent/'",
      "Step 2: Verify no errors reported for new files",
      "Step 3: Verify no errors reported for modified files"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "New code passes ruff formatting",
    "steps": [
      "Step 1: Run 'uv run ruff format --check src/claude_agent/'",
      "Step 2: Verify no formatting changes needed"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "Async functions use proper async/await patterns",
    "steps": [
      "Step 1: Review run_spec_*_session functions",
      "Step 2: Verify await is used for async calls",
      "Step 3: Verify async with is used for clients",
      "Step 4: Verify no blocking calls in async context"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "Path handling uses pathlib.Path consistently",
    "steps": [
      "Step 1: Review new code for file path handling",
      "Step 2: Verify pathlib.Path is used instead of string concatenation",
      "Step 3: Verify / operator is used for path joining"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "JSON file operations use proper error handling",
    "steps": [
      "Step 1: Review JSON read operations",
      "Step 2: Verify try/except for JSONDecodeError",
      "Step 3: Verify try/except for IOError",
      "Step 4: Verify graceful fallback on errors"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "Atomic file writes for spec-workflow.json",
    "steps": [
      "Step 1: Review save_spec_workflow_state implementation",
      "Step 2: Verify temp file + rename pattern is used",
      "Step 3: Verify temp file is cleaned up on error"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "WIZARD_STYLE is imported from wizard.py in spec_wizard.py",
    "steps": [
      "Step 1: Open spec_wizard.py",
      "Step 2: Verify import of WIZARD_STYLE from wizard module",
      "Step 3: Verify WIZARD_STYLE is used in questionary calls"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "spec_wizard uses questionary for interactive prompts",
    "steps": [
      "Step 1: Open spec_wizard.py",
      "Step 2: Verify questionary import",
      "Step 3: Verify questionary.text is used for text input",
      "Step 4: Verify questionary.select is used for selections",
      "Step 5: Verify questionary.confirm is used for confirmations"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec workflow respects project_dir option across all subcommands",
    "steps": [
      "Step 1: Create temp directory",
      "Step 2: Run spec create -p <temp>",
      "Step 3: Verify files created in temp directory",
      "Step 4: Run spec status -p <temp>",
      "Step 5: Verify status shows temp directory files"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec workflow uses configured model from config file",
    "steps": [
      "Step 1: Create .claude-agent.yaml with custom model",
      "Step 2: Run spec create",
      "Step 3: Verify Claude client uses configured model"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec workflow uses configured max_turns from config file",
    "steps": [
      "Step 1: Create .claude-agent.yaml with agent.max_turns=500",
      "Step 2: Run spec create",
      "Step 3: Verify Claude client uses max_turns=500"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Security hooks are applied to spec workflow sessions",
    "steps": [
      "Step 1: Run spec create",
      "Step 2: Verify configure_security is called",
      "Step 3: Verify stack is detected and used for security config"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Extra commands from config are passed to security",
    "steps": [
      "Step 1: Create config with security.extra_commands=['docker']",
      "Step 2: Run spec create",
      "Step 3: Verify extra_commands are passed to configure_security"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec create prints header with step number",
    "steps": [
      "Step 1: Run spec create and capture output",
      "Step 2: Verify 'STEP 1: CREATE' appears in output",
      "Step 3: Verify description mentions specification creation"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec validate prints header with step number",
    "steps": [
      "Step 1: Run spec validate and capture output",
      "Step 2: Verify 'STEP 2: VALIDATE' appears in output",
      "Step 3: Verify description mentions validation"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec decompose prints header with step number and feature count",
    "steps": [
      "Step 1: Run spec decompose -f 75 and capture output",
      "Step 2: Verify 'STEP 3: DECOMPOSE' appears in output",
      "Step 3: Verify '~75 features' appears in output"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec workflow prints goal (truncated if long) at start",
    "steps": [
      "Step 1: Run spec auto with long goal (>100 chars)",
      "Step 2: Verify goal is printed",
      "Step 3: Verify goal is truncated with '...' if >100 chars"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "integration",
    "description": "Spec workflow integrates with existing agent without conflicts",
    "steps": [
      "Step 1: Run spec auto to create feature_list.json",
      "Step 2: Run main claude-agent command",
      "Step 3: Verify no import errors",
      "Step 4: Verify no runtime conflicts",
      "Step 5: Verify existing agent behavior unchanged"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "integration",
    "description": "Existing --spec flag still works for direct spec input",
    "steps": [
      "Step 1: Create SPEC.md file",
      "Step 2: Run 'claude-agent --spec SPEC.md'",
      "Step 3: Verify initializer agent runs (not spec workflow)",
      "Step 4: Verify feature_list.json is created"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "integration",
    "description": "Existing --goal flag still works for direct goal input",
    "steps": [
      "Step 1: Run 'claude-agent --goal \"Build a todo app\"'",
      "Step 2: Verify initializer agent runs (not spec workflow)",
      "Step 3: Verify feature_list.json is created"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "integration",
    "description": "Existing wizard still works when no spec provided",
    "steps": [
      "Step 1: Run 'claude-agent' in empty directory without --spec or --goal",
      "Step 2: Verify wizard launches",
      "Step 3: Verify wizard behavior unchanged"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "integration",
    "description": "Existing reset flag clears spec workflow files",
    "steps": [
      "Step 1: Run spec auto to create all files",
      "Step 2: Run 'claude-agent --reset'",
      "Step 3: Verify spec-draft.md is listed for deletion",
      "Step 4: Verify spec-validated.md is listed for deletion",
      "Step 5: Verify spec-workflow.json is listed for deletion"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "integration",
    "description": "Status command shows spec workflow state alongside existing status",
    "steps": [
      "Step 1: Run spec auto to create files",
      "Step 2: Run 'claude-agent status'",
      "Step 3: Verify spec workflow phase is shown",
      "Step 4: Verify existing status info (feature counts) is also shown"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "generate_config_template includes workflow section",
    "steps": [
      "Step 1: Call generate_config_template()",
      "Step 2: Verify 'workflow:' section is present in output",
      "Step 3: Verify default values are documented"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Config template has commented workflow examples",
    "steps": [
      "Step 1: Call generate_config_template()",
      "Step 2: Verify workflow options are commented",
      "Step 3: Verify auto_spec example is included"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "Unit tests exist for get_spec_workflow_state",
    "steps": [
      "Step 1: Check tests/test_spec_workflow.py exists",
      "Step 2: Verify TestSpecWorkflowState class exists",
      "Step 3: Verify test_get_state_returns_empty_for_new_project test exists"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "Unit tests exist for save_spec_workflow_state",
    "steps": [
      "Step 1: Check tests/test_spec_workflow.py exists",
      "Step 2: Verify test_save_and_load_state_roundtrip test exists"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "Unit tests exist for record_spec_step",
    "steps": [
      "Step 1: Check tests/test_spec_workflow.py exists",
      "Step 2: Verify test_record_step_appends_to_history test exists"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "Unit tests exist for get_spec_phase",
    "steps": [
      "Step 1: Check tests/test_spec_workflow.py exists",
      "Step 2: Verify TestSpecPhaseDetection class exists",
      "Step 3: Verify tests for each phase value exist"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "Unit tests exist for WorkflowConfig",
    "steps": [
      "Step 1: Check tests/test_spec_workflow.py exists",
      "Step 2: Verify TestWorkflowConfig class exists",
      "Step 3: Verify test_default_values test exists"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "Unit tests exist for prompt loader functions",
    "steps": [
      "Step 1: Check tests/test_spec_workflow.py exists",
      "Step 2: Verify TestPromptLoading class exists",
      "Step 3: Verify tests for each get_spec_*_prompt function exist"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "CLI integration tests exist for spec commands",
    "steps": [
      "Step 1: Check tests/test_spec_cli.py exists",
      "Step 2: Verify TestSpecCLI class exists",
      "Step 3: Verify tests use CliRunner for testing"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "All unit tests pass",
    "steps": [
      "Step 1: Run 'uv run pytest tests/test_spec_workflow.py -v'",
      "Step 2: Verify all tests pass",
      "Step 3: Verify no warnings"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "All CLI tests pass",
    "steps": [
      "Step 1: Run 'uv run pytest tests/test_spec_cli.py -v'",
      "Step 2: Verify all tests pass",
      "Step 3: Verify no warnings"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "Full test suite passes including new tests",
    "steps": [
      "Step 1: Run 'uv run pytest -v'",
      "Step 2: Verify all tests pass",
      "Step 3: Verify no regressions in existing tests"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Prompt templates specify not to generate feature_list.json in create step",
    "steps": [
      "Step 1: Read spec_create.md",
      "Step 2: Verify DO NOT instruction mentions feature_list.json",
      "Step 3: Verify instruction is clear about decompose step responsibility"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Prompt templates specify not to write application code in create step",
    "steps": [
      "Step 1: Read spec_create.md",
      "Step 2: Verify DO NOT instruction mentions application code"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "spec_validate.md instructs creation of two output files",
    "steps": [
      "Step 1: Read spec_validate.md",
      "Step 2: Verify OUTPUT 1: spec-validation.md is documented",
      "Step 3: Verify OUTPUT 2: spec-validated.md is documented",
      "Step 4: Verify conditions for creating spec-validated.md (only if PASS)"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "spec_validate.md includes all validation categories",
    "steps": [
      "Step 1: Read spec_validate.md",
      "Step 2: Verify Completeness category is mentioned",
      "Step 3: Verify Ambiguities category is mentioned",
      "Step 4: Verify Scope Risks category is mentioned",
      "Step 5: Verify Technical Gaps category is mentioned",
      "Step 6: Verify Contradictions category is mentioned"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "spec_decompose.md specifies all feature categories",
    "steps": [
      "Step 1: Read spec_decompose.md",
      "Step 2: Verify functional category is documented",
      "Step 3: Verify technical category is documented",
      "Step 4: Verify style category is documented",
      "Step 5: Verify integration category is documented",
      "Step 6: Verify error-handling category is documented"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "spec_decompose.md explains requires_manual_testing flag",
    "steps": [
      "Step 1: Read spec_decompose.md",
      "Step 2: Verify MANUAL TESTING FLAG section exists",
      "Step 3: Verify conditions for setting true are listed"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "spec_decompose.md emphasizes feature independence and ordering",
    "steps": [
      "Step 1: Read spec_decompose.md",
      "Step 2: Verify independence guideline is mentioned",
      "Step 3: Verify ordering guideline (foundational first) is mentioned"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec create outputs summary after completion",
    "steps": [
      "Step 1: Run spec create and capture output",
      "Step 2: Verify summary of what was created is printed",
      "Step 3: Verify path to spec-draft.md is shown"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec validate outputs summary with issue counts",
    "steps": [
      "Step 1: Run spec validate and capture output",
      "Step 2: Verify issue counts by severity are printed",
      "Step 3: Verify overall verdict (PASS/FAIL) is shown"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec decompose outputs summary with feature counts by category",
    "steps": [
      "Step 1: Run spec decompose and capture output",
      "Step 2: Verify total feature count is printed",
      "Step 3: Verify counts by category are shown",
      "Step 4: Verify manual testing count is shown"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec workflow records goal in spec-workflow.json",
    "steps": [
      "Step 1: Run spec create with goal",
      "Step 2: Read spec-workflow.json",
      "Step 3: Verify goal field contains the provided goal"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec workflow records created_at timestamp",
    "steps": [
      "Step 1: Run spec create",
      "Step 2: Read spec-workflow.json",
      "Step 3: Verify created_at field exists",
      "Step 4: Verify created_at is valid ISO 8601 timestamp"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec workflow records updated_at timestamp on each step",
    "steps": [
      "Step 1: Run spec create",
      "Step 2: Note updated_at timestamp",
      "Step 3: Run spec validate",
      "Step 4: Verify updated_at has changed",
      "Step 5: Verify updated_at is newer than original"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec workflow records spec_file path in state",
    "steps": [
      "Step 1: Run spec create",
      "Step 2: Read spec-workflow.json",
      "Step 3: Verify spec_file is 'spec-draft.md'",
      "Step 4: Run spec validate (passing)",
      "Step 5: Verify spec_file updated to 'spec-validated.md'"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "History entries include output_file for each step",
    "steps": [
      "Step 1: Run spec auto to completion",
      "Step 2: Read spec-workflow.json",
      "Step 3: Verify create entry has output_file='spec-draft.md'",
      "Step 4: Verify validate entry has output_file='spec-validated.md'",
      "Step 5: Verify decompose entry has output_file='feature_list.json'"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Validate history entry includes validation_report field",
    "steps": [
      "Step 1: Run spec validate",
      "Step 2: Read spec-workflow.json",
      "Step 3: Verify validate entry has validation_report='spec-validation.md'"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "error-handling",
    "description": "Spec status handles missing project directory gracefully",
    "steps": [
      "Step 1: Run 'uv run claude-agent spec status -p /nonexistent/path'",
      "Step 2: Verify clear error message",
      "Step 3: Verify non-zero exit code"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "error-handling",
    "description": "Spec create handles permission errors on project directory",
    "steps": [
      "Step 1: Create directory with no write permissions",
      "Step 2: Run spec create -p <readonly-dir>",
      "Step 3: Verify clear error message about permissions",
      "Step 4: Verify non-zero exit code"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "error-handling",
    "description": "Spec validate handles non-UTF8 spec file gracefully",
    "steps": [
      "Step 1: Create spec-draft.md with binary content",
      "Step 2: Run spec validate",
      "Step 3: Verify error message about file encoding",
      "Step 4: Verify no crash"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "integration",
    "description": "Spec workflow files are gitignore-friendly (no secrets)",
    "steps": [
      "Step 1: Run spec auto",
      "Step 2: Examine all generated files",
      "Step 3: Verify no sensitive data in spec-workflow.json",
      "Step 4: Verify no API keys or credentials in any file"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Multiple spec workflow runs preserve history",
    "steps": [
      "Step 1: Run spec create with goal A",
      "Step 2: Run spec create with goal B (overwrite)",
      "Step 3: Read spec-workflow.json",
      "Step 4: Verify history contains both create entries",
      "Step 5: Verify goal field shows most recent goal"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec workflow can be restarted after partial completion",
    "steps": [
      "Step 1: Run spec create",
      "Step 2: Manually delete spec-draft.md",
      "Step 3: Run spec create again",
      "Step 4: Verify new spec-draft.md is created",
      "Step 5: Verify history shows two create entries"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec status shows correct next step suggestion based on phase",
    "steps": [
      "Step 1: Create spec-draft.md only",
      "Step 2: Run spec status",
      "Step 3: Verify suggestion mentions 'spec validate'",
      "Step 4: Create spec-validated.md",
      "Step 5: Run spec status",
      "Step 6: Verify suggestion mentions 'spec decompose'"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "style",
    "description": "Interactive mode uses consistent styling with existing wizard",
    "steps": [
      "Step 1: Run spec create -i",
      "Step 2: Verify prompt colors match wizard style",
      "Step 3: Verify pointer style matches wizard style",
      "Step 4: Compare with existing wizard.py styling"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "style",
    "description": "Interactive mode header matches wizard format",
    "steps": [
      "Step 1: Run spec create -i",
      "Step 2: Verify header uses '=' separators",
      "Step 3: Verify header width matches wizard (60 chars)"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "spec_wizard.py follows project code style guidelines",
    "steps": [
      "Step 1: Open spec_wizard.py",
      "Step 2: Verify module docstring format matches project style",
      "Step 3: Verify 4-space indentation",
      "Step 4: Verify double quotes for strings",
      "Step 5: Verify snake_case function names"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "New prompts use {{variable}} syntax consistently",
    "steps": [
      "Step 1: Review spec_create.md",
      "Step 2: Review spec_validate.md",
      "Step 3: Review spec_decompose.md",
      "Step 4: Verify all use {{variable}} syntax, not ${variable} or other formats"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec prompts include clear role identification",
    "steps": [
      "Step 1: Read spec_create.md and find 'YOUR ROLE' section",
      "Step 2: Read spec_validate.md and find 'YOUR ROLE' section",
      "Step 3: Read spec_decompose.md and find 'YOUR ROLE' section",
      "Step 4: Verify role names are distinct and descriptive"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec prompts include clear task description",
    "steps": [
      "Step 1: Read spec_create.md and find 'YOUR TASK' section",
      "Step 2: Read spec_validate.md and find 'YOUR TASK' section",
      "Step 3: Read spec_decompose.md and find 'YOUR TASK' section",
      "Step 4: Verify task sections clearly describe expected output"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec prompts include OUTPUT section specifying files to create",
    "steps": [
      "Step 1: Read spec_create.md and find OUTPUT section",
      "Step 2: Verify spec-draft.md is specified",
      "Step 3: Read spec_validate.md and find OUTPUT sections",
      "Step 4: Verify both spec-validation.md and spec-validated.md are specified",
      "Step 5: Read spec_decompose.md and find OUTPUT section",
      "Step 6: Verify feature_list.json and app_spec.txt are specified"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "integration",
    "description": "Spec workflow prompts are compatible with Claude's writing tools",
    "steps": [
      "Step 1: Review spec_create.md for file write instructions",
      "Step 2: Verify instructions use 'Create' or 'Write' verbs",
      "Step 3: Verify file paths are clearly specified",
      "Step 4: Verify no conflicting tool instructions"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Documentation: README includes spec workflow section",
    "steps": [
      "Step 1: Read README.md",
      "Step 2: Verify 'Spec Workflow' section exists",
      "Step 3: Verify Quick Start example is provided",
      "Step 4: Verify Step-by-Step example is provided",
      "Step 5: Verify Combined Mode example is provided"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Documentation: AGENTS.md mentions spec commands",
    "steps": [
      "Step 1: Read AGENTS.md (or CLAUDE.md)",
      "Step 2: Verify spec subcommands are documented",
      "Step 3: Verify spec workflow files are listed"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "No new external dependencies added",
    "steps": [
      "Step 1: Read pyproject.toml",
      "Step 2: Verify dependencies list unchanged",
      "Step 3: Verify all imports use existing dependencies (click, questionary, yaml)"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "Package exports updated for new functions",
    "steps": [
      "Step 1: Read src/claude_agent/__init__.py",
      "Step 2: Verify relevant new functions are exported if needed",
      "Step 3: Verify __all__ list is updated if present"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "integration",
    "description": "Version number unchanged for feature addition",
    "steps": [
      "Step 1: Read pyproject.toml version",
      "Step 2: Read src/claude_agent/__init__.py version",
      "Step 3: Verify versions match",
      "Step 4: Note: version bump should happen at release time, not feature time"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec workflow respects skip_if_feature_list_exists config",
    "steps": [
      "Step 1: Create feature_list.json in project directory",
      "Step 2: Set workflow.auto_spec.skip_if_feature_list_exists=true in config",
      "Step 3: Run with --auto-spec",
      "Step 4: Verify spec workflow is skipped",
      "Step 5: Set skip_if_feature_list_exists=false",
      "Step 6: Run with --auto-spec",
      "Step 7: Verify spec workflow runs"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI properly resolves relative project paths to absolute",
    "steps": [
      "Step 1: Run spec status -p ./relative/path",
      "Step 2: Verify path is resolved to absolute in output",
      "Step 3: Verify files are created in correct absolute location"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI creates project directory if it doesn't exist",
    "steps": [
      "Step 1: Run spec create -p /tmp/new-project-dir -g 'test'",
      "Step 2: Verify /tmp/new-project-dir is created",
      "Step 3: Verify spec-draft.md is created inside"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "error-handling",
    "description": "Spec workflow handles session timeout gracefully",
    "steps": [
      "Step 1: Configure short timeout for Claude client",
      "Step 2: Run spec create with complex goal",
      "Step 3: Verify timeout is handled",
      "Step 4: Verify clear error message",
      "Step 5: Verify partial progress is preserved if any"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "error-handling",
    "description": "Spec workflow handles network errors gracefully",
    "steps": [
      "Step 1: Simulate network disconnection",
      "Step 2: Run spec create",
      "Step 3: Verify network error is caught",
      "Step 4: Verify clear error message",
      "Step 5: Verify suggestion to retry"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec create prompt specifies output file name explicitly",
    "steps": [
      "Step 1: Read spec_create.md prompt",
      "Step 2: Verify 'spec-draft.md' filename is specified",
      "Step 3: Verify filename appears in OUTPUT section"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec validate prompt specifies both output filenames",
    "steps": [
      "Step 1: Read spec_validate.md prompt",
      "Step 2: Verify 'spec-validation.md' is specified",
      "Step 3: Verify 'spec-validated.md' is specified"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec decompose prompt specifies app_spec.txt copy instruction",
    "steps": [
      "Step 1: Read spec_decompose.md prompt",
      "Step 2: Verify instruction to copy spec to app_spec.txt",
      "Step 3: Verify this is mentioned in OUTPUT section"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "integration",
    "description": "Spec workflow uses same security configuration as coding agent",
    "steps": [
      "Step 1: Configure extra_commands in .claude-agent.yaml",
      "Step 2: Run spec create",
      "Step 3: Verify security is configured with extra_commands",
      "Step 4: Run coding agent",
      "Step 5: Verify same security configuration applies"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "integration",
    "description": "Spec workflow detects stack from project files",
    "steps": [
      "Step 1: Create package.json in project directory",
      "Step 2: Run spec create",
      "Step 3: Verify node stack is detected",
      "Step 4: Verify security is configured for node stack"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "WorkflowConfig has correct type hints",
    "steps": [
      "Step 1: Inspect WorkflowConfig dataclass",
      "Step 2: Verify default field has type str",
      "Step 3: Verify auto_spec_enabled has type bool",
      "Step 4: Verify skip_if_feature_list_exists has type bool"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Config.workflow field uses field with default_factory",
    "steps": [
      "Step 1: Inspect Config dataclass",
      "Step 2: Verify workflow field exists",
      "Step 3: Verify it uses field(default_factory=WorkflowConfig)"
    ],
    "passes": true,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "spec_wizard.py imports WIZARD_STYLE correctly",
    "steps": [
      "Step 1: Open spec_wizard.py",
      "Step 2: Verify 'from claude_agent.wizard import WIZARD_STYLE' exists",
      "Step 3: Verify no ImportError when module loads"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "All prompt templates are valid markdown",
    "steps": [
      "Step 1: Read spec_create.md",
      "Step 2: Read spec_validate.md",
      "Step 3: Read spec_decompose.md",
      "Step 4: Verify each parses as valid markdown",
      "Step 5: Verify no unclosed code blocks"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "get_spec_create_prompt handles empty goal gracefully",
    "steps": [
      "Step 1: Call get_spec_create_prompt with empty string",
      "Step 2: Verify no exception is raised",
      "Step 3: Verify prompt is still rendered"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "get_spec_decompose_prompt handles zero feature count",
    "steps": [
      "Step 1: Call get_spec_decompose_prompt with feature_count=0",
      "Step 2: Verify no exception is raised",
      "Step 3: Verify '0' appears in prompt"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec workflow state includes spec_file field",
    "steps": [
      "Step 1: Run spec create",
      "Step 2: Read spec-workflow.json",
      "Step 3: Verify spec_file field exists",
      "Step 4: Verify value is 'spec-draft.md'"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "History entries include status field",
    "steps": [
      "Step 1: Run spec create",
      "Step 2: Read spec-workflow.json",
      "Step 3: Verify history entry has status field",
      "Step 4: Verify status is 'complete' or 'error'"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "integration",
    "description": "Spec workflow works with absolute project paths",
    "steps": [
      "Step 1: Get absolute path of temp directory",
      "Step 2: Run spec create -p /absolute/path -g 'test'",
      "Step 3: Verify files created at absolute path",
      "Step 4: Verify no path resolution issues"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "integration",
    "description": "Spec workflow works with paths containing spaces",
    "steps": [
      "Step 1: Create directory with spaces in name",
      "Step 2: Run spec create -p 'path with spaces' -g 'test'",
      "Step 3: Verify no errors from path handling",
      "Step 4: Verify files created correctly"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "CLI spec create accepts long multiline goals",
    "steps": [
      "Step 1: Create goal.txt with 500+ character multiline goal",
      "Step 2: Run spec create --from-file goal.txt",
      "Step 3: Verify full goal is passed to session",
      "Step 4: Verify no truncation"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec status shows correct timestamp format",
    "steps": [
      "Step 1: Run spec create",
      "Step 2: Run spec status",
      "Step 3: Verify timestamps are human-readable",
      "Step 4: Verify ISO 8601 format is parsed correctly"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "style",
    "description": "Spec status output aligns labels consistently",
    "steps": [
      "Step 1: Run spec status",
      "Step 2: Verify 'Phase:' label is aligned",
      "Step 3: Verify file status labels are aligned",
      "Step 4: Compare alignment with existing status command"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "run_spec_workflow uses config.features for decompose step",
    "steps": [
      "Step 1: Create config with features=100",
      "Step 2: Run spec auto",
      "Step 3: Verify decompose session receives feature_count=100"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "functional",
    "description": "Spec auto truncates long goals in console output",
    "steps": [
      "Step 1: Run spec auto with 200+ character goal",
      "Step 2: Capture console output",
      "Step 3: Verify goal is truncated to ~100 chars with '...'",
      "Step 4: Verify full goal is still used in session"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "technical",
    "description": "Test files use pytest fixtures correctly",
    "steps": [
      "Step 1: Open test_spec_workflow.py",
      "Step 2: Verify tmp_path fixture is used for temp directories",
      "Step 3: Open test_spec_cli.py",
      "Step 4: Verify CliRunner fixture is properly defined"
    ],
    "passes": false,
    "requires_manual_testing": false
  },
  {
    "category": "integration",
    "description": "Full end-to-end spec workflow produces working feature list for coding agent",
    "steps": [
      "Step 1: Run spec auto -g 'Build a simple counter app'",
      "Step 2: Verify all spec files are created",
      "Step 3: Verify feature_list.json has valid structure",
      "Step 4: Run claude-agent (coding agent)",
      "Step 5: Verify coding agent starts implementing features",
      "Step 6: Verify no errors from feature list parsing",
      "Step 7: Verify progress tracking works correctly",
      "Step 8: Verify agent can mark features as passing",
      "Step 9: Check claude-progress.txt is updated",
      "Step 10: Verify validation triggers when all automated tests pass"
    ],
    "passes": false,
    "requires_manual_testing": false
  }
]